{% extends 'flashcards/base.html' %}

{% block content %}
<div id="current_flashcard" onclick="flip();">
    <p id="all_data" hidden> {{deck}} </p>
    <p id="front"></p>
    <!--todo check somewhere previously, that deck.flachcards is not empty-->
    <p id="back"></p>
    <button id="wrong" onclick="addcard(); nextcard();">wrong</button>
    <button id="right" onclick="popcard(); nextcard();">right</button>
</div>
{% endblock %}



{% block script %}


<script type="text/javascript">
    document.addEventListener('keypress', function(event) {
        if (event.keyCode == 32) {
            flip();
            //space
        } else if (event.key == 'd') {
            document.getElementById('right').click()
        } else if (event.key == 'a') {
            document.getElementById('wrong').click()
        }
    });
    document.addEventListener('keydown', function(event) {
        if (event.key == 'ArrowRight') {
            document.getElementById('right').click()
        } else if (event.key == 'ArrowLeft') {
            document.getElementById('wrong').click()
        }
    });
    var data = document.getElementById("all_data").innerHTML;
    data = JSON.parse(data);
    var fronts = Object.keys(data);
    // todo check if data is not empty ( in django view mb)
    var current = 0;

    document.getElementById('front').innerHTML = fronts[current];
    document.getElementById('back').innerHTML = data[fronts[current]];
    document.getElementById('back').hidden = true;


    function nextcard() {
        current = current + 1;
        if (current > fronts.length) {
            //todo show restart buton which redirects somewhere
        } else {
            document.getElementById('front').innerHTML = fronts[current];
            document.getElementById('back').innerHTML = data[fronts[current]];
            // manage right and wrong stuff? oh gotcha: thats what popcard and addcard are for
        }
    }

    function popcard() {}

    function addcard() {}

    function flip() {
        let front = document.getElementById('front');
        let back = document.getElementById('back');
        if (front.hidden) {
            front.hidden = false;
            back.hidden = true;
        } else {
            front.hidden = true;
            back.hidden = false;
        }
    }

</script>
{% endblock %}
